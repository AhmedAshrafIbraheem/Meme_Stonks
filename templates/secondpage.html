{% extends "base.html" %}
{% block content %}
    <div class="row">
        <div class="twelve columns">
            <p><h3 class="centered_header text_color_green">Intraday: Price</h3></p>
        </div>
    </div>
    <div class="row border1">
        <div class="row">
            <div class="twelve columns">
                <div class="center-col">
                    <h5 class="section-title">{{ data.symbol }}: Stock Price Chart</h5>

                    {% if data.Dates %}
                    <canvas id="line-chart" width="800" height="450"></canvas>
                     <script>
                   new Chart(document.getElementById("line-chart"), {
                      type: 'line',
                      data: {
                        labels: [{% for date in data.Dates %}
                            "{{ date }}",
                            {% endfor %}

                        ],
                        datasets: [{
                            data: [{% for value in data.Values %}
                                {{ value }},
                                {% endfor %}],
                            label: "Latest",
                            borderColor: "#277A2B",
                            fill: false
                          },
                        ]
                      },
                      options: {
                        title: {
                          display: true,
                          text: '{{ data.symbol }}'
                        }
                      }
                   });
                </script>
                    {% else %}
                    <h6>Not Enough Data!!!! Sorry About That</h6>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    <div class="row spacer_blank"></div>
    <div class="row border1">
        <div class="five columns">
            <h5 class="center_text">Stock Technicals</h5>
            <!--  For Symbol we will use the api to call the Stock Ticker that was clicked on to display the Symbol
                  Here we will use the api to call the Stock Ticker that was clicked on to display the Company Name -->
            <button class="button-primary">{{ data.symbol }}</button>
            <br>
            <br>
            <h6><strong>{{ data.name }}</strong></h6>
            {% if data.avg_price %}
                <strong>Average</strong> <br>
                <strong>Price:</strong> &nbsp;&nbsp;&nbsp;&nbsp;&emsp;&emsp;&emsp;&ensp;&ensp;${{ data.avg_price }}
                <br>
                <br>
                <strong>Average</strong> <br>
                <strong>Volume:</strong> &nbsp;&nbsp;&nbsp;&nbsp;&emsp;&emsp;&emsp;&ensp;{{ data.avg_vol }}
                <br>
                <br>
            {% endif %}
            <strong>Market</strong> <br>
            <strong>Capitalization:</strong> &nbsp;&nbsp;&nbsp;&nbsp;&ensp;{{ data.market_cap }}
            <br>
            <br>
            <strong>52 Week High:</strong> &nbsp;&nbsp;&nbsp;&nbsp;&ensp;${{ data.fiftytwo_week_high }}
            <br>
            <br>
            <strong>52 Week Low:</strong> &nbsp;&nbsp;&nbsp;&nbsp;&ensp;&ensp;${{ data.fiftytwo_week_low }}
            <br>
            <br>
        </div>
        <div class="seven columns">
            <h5 class="section-title center_text">Sentiment Analysis</h5>
            <button class="button-primary">Strong Buy</button>
            <br>
            <canvas id="s_a_chart"></canvas>
            <script>
                var ctx = document.getElementById("s_a_chart");

                var s_a_chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [ {% for item in data_social_dates %}
                            {% if item == data_social_dates[-1] -%}
                                "TODAY",
                            {% else -%}
                                "{{ item }}",
                            {% endif %}
                            {% endfor %} ],
                        datasets: [
                            {
                            label: "{{ data.symbol }}",
                            data: [{x: "{{ data_social_dates[0] }}", y: {{ data_social_values[0] }}}, {x: "{{ data_social_dates[1] }}", y: {{ data_social_values[1] }}}, {x: "{{ data_social_dates[2] }}", y: {{ data_social_values[2] }}}, {x: "{{ data_social_dates[3] }}", y: {{ data_social_values[3] }}}, {x: "{{ data_social_dates[4] }}", y: {{ data_social_values[4] }}}, {x: "{{ data_social_dates[5] }}", y: {{ data_social_values[5] }}}, {x: "{{ data_social_dates[6] }}", y: {{ data_social_values[6] }}}, {x: "{{ data_social_dates[7] }}", y: {{ data_social_values[7] }}}],
                            showLine: true,
                            fill: false,
                            borderColor: "#277A2B",
                            lineTension: 0
                            }
                        ]
                        },
                        options: {
                        tooltips: {
                          mode: 'index',
                          intersect: false,
                        },
                        hover: {
                          mode: 'nearest',
                          intersect: true
                        },
                        scales: {
                          yAxes: [{
                            ticks: {
                              autoSkip: false,
                              beginAtZero: true,
                              max: 100,
                              stepSize: 20
                            }
                          }],
                          xAxes: [{
                            ticks: {
                              autoSkip: false
                            }
                          }]
                        },
                      }
                    });
            </script>
        </div>
    </div>
{% endblock %}
